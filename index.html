<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel | TechWithTips</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

<style>
/* ===== PREMIUM BACKGROUND ===== */
body{
  min-height:100vh;
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,0.25), transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(255,255,255,0.2), transparent 40%),
    linear-gradient(-45deg,#ff6b35,#ff9f1c,#ffd166,#ff6b35);
  background-size:400% 400%;
  animation:bgMove 18s ease infinite;
  font-family:Segoe UI,Tahoma,sans-serif;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* ===== GLASS CARD ===== */
.glass{
  background:rgba(255,255,255,0.88);
  backdrop-filter:blur(18px);
  border-radius:22px;
  box-shadow:0 25px 60px rgba(0,0,0,0.18);
  transition:0.35s ease;
}
.glass:hover{
  transform:translateY(-6px);
  box-shadow:0 35px 80px rgba(0,0,0,0.28);
}
</style>
</head>

<body>

<!-- ================= PASSWORD SCREEN ================= -->
<div id="lockScreen" class="min-h-screen flex items-center justify-center">
  <div class="glass p-8 w-full max-w-sm text-center">
    <h2 class="text-2xl font-extrabold mb-4">üîê Admin Access</h2>
    <p class="text-gray-600 mb-4">Enter admin password to continue</p>

    <input id="adminPassword" type="password" placeholder="Enter Password"
      class="w-full border p-3 rounded-xl mb-4 text-center">

    <button onclick="checkPassword()"
      class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-full font-bold">
      Enter Dashboard
    </button>
  </div>
</div>

<!-- ================= ADMIN DASHBOARD ================= -->
<div id="adminPanel" style="display:none;">

<!-- HEADER -->
<header class="px-6 py-4 text-white"
style="background:linear-gradient(135deg,#ff6b35,#ff9f1c);
box-shadow:0 8px 30px rgba(0,0,0,.25)">
  <h1 class="text-xl font-extrabold tracking-wide">
    üöÄ TechWithTips Admin Dashboard
  </h1>
</header>

<!-- STATS -->
<section class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6 max-w-6xl mx-auto">

  <div class="glass p-6">
    <p class="text-gray-500 text-sm">Total Apps</p>
    <p id="totalApps" class="text-4xl font-extrabold text-orange-500">0</p>
  </div>

  <div class="glass p-6">
    <p class="text-gray-500 text-sm">New Apps</p>
    <p id="newApps" class="text-4xl font-extrabold text-blue-500">0</p>
  </div>

  <div class="glass p-6">
    <p class="text-gray-500 text-sm">Admin Status</p>
    <p class="text-2xl font-bold text-green-600">Unlocked üîì</p>
  </div>

</section>

<!-- FORM -->
<section class="glass max-w-4xl mx-auto p-6">
<h2 class="text-2xl font-bold mb-4 text-center">‚ûï Add / Edit App</h2>

<form id="appForm" onsubmit="handleAppForm(event)" class="grid gap-4 md:grid-cols-2">

<input type="hidden" id="editingId">

<input id="appName" required placeholder="App Name" class="border p-3 rounded-xl">
<input id="appSubtitle" required placeholder="Short Description" class="border p-3 rounded-xl">

<input id="appRank" type="number" placeholder="Rank" class="border p-3 rounded-xl">
<select id="appCategory" class="border p-3 rounded-xl">
  <option value="all">All Apps</option>
  <option value="new">New Apps</option>
</select>

<input id="appUrl" type="url" required placeholder="Download Link"
 class="border p-3 rounded-xl md:col-span-2">

<input id="appLogo" type="file" accept="image/*"
 class="border p-3 rounded-xl md:col-span-2">

<input type="hidden" id="existingLogoUrl">

<button id="appFormBtn"
 class="md:col-span-2 bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-full font-bold">
‚ûï Add App
</button>

</form>
</section>

<!-- TABLE -->
<section class="glass max-w-6xl mx-auto mt-10 p-6">
<h2 class="text-2xl font-bold mb-4">üìã All Apps</h2>

<div class="overflow-x-auto">
<table class="w-full border text-sm bg-white/80 rounded-xl overflow-hidden">
<thead class="bg-orange-100">
<tr>
  <th class="p-3 border">#</th>
  <th class="p-3 border">Name</th>
  <th class="p-3 border">Category</th>
  <th class="p-3 border">Rank</th>
  <th class="p-3 border">Actions</th>
</tr>
</thead>
<tbody id="appsTable"></tbody>
</table>
</div>
</section>

</div>

<!-- ================= PASSWORD SCRIPT ================= -->
<script>
const ADMIN_PASS = "775993";

function checkPassword(){
  const input = document.getElementById("adminPassword").value;
  if(input === ADMIN_PASS){
    document.getElementById("lockScreen").style.display="none";
    document.getElementById("adminPanel").style.display="block";
  }else{
    alert("‚ùå Wrong password");
  }
}
</script>

<!-- ================= FIREBASE ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, push, onValue, update, remove } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBwC35sh20ttnUeNsMOi8ghzsab-Db_6c4",
  databaseURL: "https://pawan-9dd64-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "pawan-9dd64",
  appId: "1:261645960158:web:69b39c9ac9e132c1ef134f"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const appsRef = ref(db,"apps");
let allApps=[];

onValue(appsRef,snap=>{
  const d=snap.val()||{};
  allApps=Object.entries(d).map(([id,v])=>({id,...v}));
  render();
});

function render(){
  totalApps.textContent=allApps.length;
  newApps.textContent=allApps.filter(a=>a.category==="new").length;

  appsTable.innerHTML=allApps.map((a,i)=>`
<tr class="text-center">
<td class="border p-3">${i+1}</td>
<td class="border p-3 font-bold">${a.name}</td>
<td class="border p-3">${a.category}</td>
<td class="border p-3">${a.rank}</td>
<td class="border p-3 space-x-2">
<button onclick="editApp('${a.id}')" class="bg-blue-500 text-white px-3 py-1 rounded-lg">Edit</button>
<button onclick="deleteApp('${a.id}')" class="bg-red-500 text-white px-3 py-1 rounded-lg">Delete</button>
</td>
</tr>`).join("");
}

async function handleAppForm(e){
  e.preventDefault();
  let logoUrl=existingLogoUrl.value;
  if(appLogo.files[0]){
    logoUrl=await new Promise(r=>{
      const fr=new FileReader();
      fr.onload=()=>r(fr.result);
      fr.readAsDataURL(appLogo.files[0]);
    });
  }

  const data={
    name:appName.value,
    subtitle:appSubtitle.value,
    rank:Number(appRank.value)||999,
    category:appCategory.value,
    url:appUrl.value,
    logoUrl
  };

  if(editingId.value){
    await update(ref(db,"apps/"+editingId.value),data);
  }else{
    await push(appsRef,data);
  }

  appForm.reset();
  editingId.value="";
  appFormBtn.textContent="‚ûï Add App";
}

function editApp(id){
  const a=allApps.find(x=>x.id===id);
  editingId.value=a.id;
  appName.value=a.name;
  appSubtitle.value=a.subtitle;
  appRank.value=a.rank;
  appCategory.value=a.category;
  appUrl.value=a.url;
  existingLogoUrl.value=a.logoUrl||"";
  appFormBtn.textContent="üíæ Update App";
}

async function deleteApp(id){
  if(confirm("Delete this app?")){
    await remove(ref(db,"apps/"+id));
  }
}

window.editApp=editApp;
window.deleteApp=deleteApp;
window.handleAppForm=handleAppForm;
</script>

</body>
</html>
